{% block content %}
<hr>
<div class="container-fluid row">
    <!--    <div class="col-md-1">-->
    <!--      <a href="{% url 'home_page' %}" class="btn btn-primary btn-block btn-lg">-->
    <!--        <i class="fas fa-arrow-left"></i>-->
    <!--      </a>-->
    <!--    </div>-->
    <div class="col-md-1.5">
        <a href="" id='add_btn' class="btn btn-warning" onclick="return confirm('Are you sure to Check-Out this stock?');">
            <i class="fas fa-plus"></i> Check-Out
        </a>
    </div>
</div>
<br>
<div class="container-fluid">
    <table  id="dispatch_master_list" class="table table-striped table-bordered">
        <thead class="thead-dark">
        <tr>
            <th>Select Stock</th>
            <th>WH Job Number</th>
            <th>WH Stock Number</th>
            <th>Number Of Pieces</th>
            <th>Dispatch Number</th>
            <th>HAWB</th>
            <th>Shipper Invoice</th>
            <th>Customer Name</th>
            <th>Consigner</th>
            <th>Consignee</th>
            <th>Customer Type</th>
            <th>Branch</th>
            <th>Unit</th>
            <th>Bay</th>
            <th>Stack</th>
            <th>Check-In Time</th>
            <th>Goods Status</th>
            <th>Scan QR Code</th>
        </thead>
        <tbody>
        {% for goodsinfo in dispatch_master_list %}
        <tr>
            <td></td>
            <td> {{goodsinfo.wh_job_no}}</td>
            <td> {{goodsinfo.wh_qr_rand_num}}</td>
            <td> {{goodsinfo.wh_goods_pieces}}</td>
            <td> {{goodsinfo.wh_dispatch_num}}</td>
            <td> {{goodsinfo.wh_gate_injob_no_id.gatein_hawb}}</td>
            <td> {{goodsinfo.wh_goods_invoice}}</td>
            <td> {{goodsinfo.wh_customer_name}}</td>
            <td> {{goodsinfo.wh_consigner}}</td>
            <td> {{goodsinfo.wh_consignee}}</td>
            <td> {{goodsinfo.wh_customer_type}}</td>
            <td> {{goodsinfo.wh_branch}}</td>
            <td> {{goodsinfo.wh_unit}}</td>
            <td> {{goodsinfo.wh_bay}}</td>
            <td> {{goodsinfo.wh_stack_layer}}</td>
            <td> {{goodsinfo.wh_checkin_time}}</td>
            <td> {{goodsinfo.wh_check_in_out}}</td>
            <td>
                <form action="{% url 'qr_dispatch_decoder' goodsinfo.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-qrcode"></i>
                    </button>
                </form>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
<!--<script>-->
<!--    $(document).ready(function() {-->
<!--    $('#dispatch_master_list').DataTable();-->
<!--} );-->
<!--</script>-->
<script>
$(document).ready(function (){
      var table=new DataTable('#dispatch_master_list', {
        columnDefs: [
            {
                orderable: false,
                className: 'select-checkbox',
                targets: 0
            }
        ],
        select: {
            style: 'os',
            selector: 'td:first-child'
      },
        order: [[1, 'asc']],
        dom: 'lBfrtip',
        scrollY: "300px",
        scrollX: true,
});

   // Handle form submission event
   $('#add_btn').on('click', function(){
      	var rows_selected = table.column(0).selected();
      	let selectedValues = table.rows( { selected: true } ).data();
      	var len1=( selectedValues ).length;
      	console.log( len1 );
      	var len=( selectedValues[0] ).length;
      	console.log( selectedValues );
      	console.log( selectedValues[0] );
      	console.log( len );
      	var elements = [];
      	for (var i = 0; i < len1; i++) {
				console.log(selectedValues[i][2]);
				elements.push(selectedValues[i][2]);
			}
		var elements_list=elements;
   $.ajax({
        url: '{% url 'dispatch_add_goods' %}',
        type: 'GET',
        data: {
            'myList[]': elements_list,  // This will encode the list as URL parameters
        },
        success: function(response) {
            // Handle the response from the Django view
        },
   });

   });
});
</script>
{% endblock content %}
