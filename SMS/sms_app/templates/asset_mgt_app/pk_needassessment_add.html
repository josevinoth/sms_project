{% extends "asset_mgt_app/base.html" %}
{% load widget_tweaks %}

{% block content %}

<div class="row" >
	<div class="col-2"></div>
	<div class="col-8">
		<div class="container-fluid">
			<div class="card text-white bg-info mb-3" style="max-width: 100%;">
				<div class="card-header text-center"><h3>Add/Update Need Assessment</h3></div>
				<div class="card-body bg-light" >
					<form method="POST" action="" id="needassessment_add" enctype="multipart/form-data">
						{% csrf_token %}
						<div class="row" id="need_assessment_main">
							<div class="col-6">
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Assessment NO.</span>
									</div>
									{% render_field form.na_assessment_num id="na_assessment_num"  readonly="True"  class="form-control" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Date</span>
									</div>
									{% render_field form.na_date id="na_date" type="Date" class="form-control" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Customer Name</span>
									</div>
									{% render_field form.na_customer_name id="na_customer_name" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Type Of Work</span>
									</div>
									{% render_field form.na_type_of_work id="na_type_of_work" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Type Of Packing</span>
									</div>
									{% render_field form.na_type_of_pack id="na_type_of_pack" class="form-control " onchange="package_type_change()" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Others</span>
									</div>
									{% render_field form.na_others_type_pack id="na_others_type_pack" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Wood Treatment Requirement</span>
									</div>
									{% render_field form.na_wood_treatment_req  id="na_wood_treatment_req" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Special Requirements</span>
									</div>
									{% render_field form.na_special_requirements id="na_special_requirements" class="form-control select2-multiple-checkbox" multiple="multiple" style="height:150px" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Unloading</span>
									</div>
									{% render_field form.na_unloading id="na_unloading" class="form-control " %}
								</div>
							</div>
							<div class="col-6">
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Wood Norms</span>
									</div>
									{% render_field form.na_wood_norms id="na_wood_norms" class="form-control select2-multiple-checkbox" multiple="multiple" style="height:150px" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Delivery By</span>
									</div>
									{% render_field form.na_delivery_by id="na_delivery_by" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Delivery Type</span>
									</div>
									{% render_field form.na_delivery_type id="na_delivery_type" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Delivery Location</span>
									</div>
									{% render_field form.na_delivery_location id="na_delivery_location" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Vehicle Type</span>
									</div>
									{% render_field form.na_vehicle_type id="na_vehicle_type" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Type Of Lifting</span>
									</div>
									{% render_field form.na_type_of_access id="na_type_of_access" class="form-control select2-multiple-checkbox" multiple="multiple"  %}
								</div>

								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Consumables</span>
									</div>
									{% render_field form.na_consumables id="na_consumables" class="form-control select2-multiple-checkbox" multiple="multiple"  %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Packing Field</span>
									</div>
									{% render_field form.na_packing_field id="na_packing_field" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Status</span>
									</div>
									{% render_field form.na_status id="na_status" class="form-control " %}
								</div>
								{% render_field form.na_updated_by id="na_updated_by" hidden="True" class="form-control " %}
								{% render_field form.nad_cost_unit id="nad_cost_unit" hidden="True" class="form-control " %}
								{% render_field form.nad_cost_total id="nad_cost_total" hidden="True" class="form-control " %}
							</div>
						</div>
						<div class="input-group input-group-sm mb-3 bg-dark block">
							<div class="input-group-prepend">
								<span class="input-group-text">Attachment</span>
							</div>
							{% render_field form.na_attach id="na_attach" class="form-control " %}
						</div>
						<div class="row">
							<div class="col-1"></div>
							<div class="col-10">
								<div class="message text-center">
									{% for message in messages %}
									<a {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</a>
									{% endfor %}
								</div>
							</div>
							<div class="col-1"></div>
						</div>
						<button id="na_submit_btn" type="submit" class="btn btn-success "><i class="fas fa-check"></i> Submit</button>
						<a href="{% url 'needassessment_list' %}" class="btn btn-danger float-right">
							<i class="fas fa-times"></i> Cancel
						</a>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="col-2"></div>
</div>
<hr>
<div class="row">
	<div class="col-1"></div>
	<div class="col-10">
		<div id="accordion" class="container-fluid">
			<div class="card">
				<div class="card-header bg-info" id="headingOne">
					<h5 class="mb-0">
						<button class="btn btn-warning text-white" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
							Add/Edit Comments
						</button>
					</h5>
				</div>
				<div id="collapseOne" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
					<div class="card-body">
						<div id="comments_list_WOH">
							{% include "asset_mgt_app/comments_list_WOH.html" %}
						</div>
					</div>
				</div>
			</div>
			<div class="card">
				<div class="card-header bg-info" id="headingTwo">
					<h5 class="mb-0">
						<button class="btn btn-warning text-white collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
							Add/Edit Dimensions
						</button>
					</h5>
				</div>
				<div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
					<div class="card-body">
						<div class="card-body">
							<div id="na_dimension_list_WOH">
								{% include "asset_mgt_app/na_dimension_list_WOH.html" %}
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-1"></div>
</div>


<script>
	$(document).ready(function() {
    document.getElementById("na_updated_by").value ='{{user_id}}';
    $('#na_dimension_list').DataTable({
        dom: 'lBfrtip',
        buttons: [
            'copy', 'csv', 'excel','print'
        ]
    });
    var assessment_num = document.getElementById("na_assessment_num").value
    if (assessment_num =="")
    {
        $('#add_dim_btn').addClass('disable_a_href');
        $('#comments_add_btn').addClass('disable_a_href');
        $('#comments_list_WOH').addClass('disable_a_href');
    }
    else
    {
        $('#add_dim_btn').removeClass('disable_a_href');
        $('#comments_add_btn').removeClass('disable_a_href');
        $('#comments_list_WOH').removeClass('disable_a_href');
    }
} );
</script>

<script>
	$(document).ready(function() {
        var user_role='{{role}}'
        var status=document.getElementById("na_status").value
        if (status==5)
        {
            if (user_role=="User")
            {
                alert('Since Status is Completed,you have read-only access. To edit, please contact Administrator')
                // Disable all form input fields

                // Hide the submit button
                $('#na_submit_btn').addClass('disable_a_href');
                $('#need_assessment_main').addClass('disable_a_href');
                $('#comments_list_WOH').addClass('disable_a_href');
                $('#na_dimension_list_WOH').addClass('disable_a_href');
            }
        }
        package_type_change()
    });
</script>

<script>
	function package_type_change() {
        var type_packing = document.getElementById("na_type_of_pack").value;
        if (type_packing == 7) {
            $('#na_others_type_pack').removeClass('disable_a_href');
        } else {
            $('#na_others_type_pack').addClass('disable_a_href');
             document.getElementById("na_others_type_pack").value =" ";
        }
    }
</script>

<script>
	$(document).ready(function() {
    $('#comments_list').DataTable();
} );
</script>
<style>
    /* Custom styles for multiselect dropdown */
    .multiselect-container {
        max-width: 1000px !important;  /* Set your desired max width for the dropdown */
        min-width: 375px;              /* Ensure a minimum width */
        width: 100% !important;        /* Ensure it fills the width of the button */
        box-sizing: border-box;        /* Ensure padding and border are included in width */
    }

    .custom-multiselect-button {
        border: 1px solid lightgray;  /* Light border for the button */
    }
	.multiselect-container li a label {
    display: flex;
    align-items: center;
    cursor: pointer; /* Ensures the entire label is clickable */
}

/* Position the checkbox after the text */
.multiselect-container li a label input[type="checkbox"] {
    margin-left: -150px; /* Space between text and checkbox */
}

    /* Position the input box (checkbox) before the text and align it */


    /* Correct alignment of the checkbox to be line-wise with text */
    .multiselect-container li a label {
        cursor: pointer; /* Ensures the entire area is clickable */
        height: auto; /* Adjusts height based on content, ensuring vertical center alignment */
    }
</style>

<script>
    $(document).ready(function() {
        // Initialize DataTables
        $('#yourTableId').DataTable({
            // DataTable options
        });

        // Initialize Multiselect for Type of Lifting
        $('#na_type_of_access').multiselect({
            includeSelectAllOption: true,
            enableFiltering: true,
            enableCaseInsensitiveFiltering: true,
            buttonWidth: '375px',  // Increase the width of the button
            nonSelectedText: 'Select Types of Lifting',
            buttonClass: 'custom-multiselect-button',
             maxHeight: 250, // Set a max height for the dropdown with a scrollbar
            dropUp: false
        });

        // Initialize Multiselect for Special Requirements
        $('#na_special_requirements').multiselect({
            includeSelectAllOption: false,
            enableFiltering: true,
            enableCaseInsensitiveFiltering: true,
            buttonWidth: '375px',
            nonSelectedText: 'Select Special Requirements',
            buttonClass: 'custom-multiselect-button',
             maxHeight: 250, // Set a max height for the dropdown with a scrollbar
            dropUp: false
        });

        // Initialize Multiselect for Wood Norms
        $('#na_wood_norms').multiselect({
            includeSelectAllOption: true,
            enableFiltering: true,
            enableCaseInsensitiveFiltering: true,
            buttonWidth: '375px',
            nonSelectedText: 'Select Wood Norms',
            buttonClass: 'custom-multiselect-button',
             maxHeight: 250, // Set a max height for the dropdown with a scrollbar
            dropUp: false
        });
        // Initialize Multiselect for Wood Norms
        $('#na_consumables').multiselect({
            includeSelectAllOption: true,
            enableFiltering: true,
            enableCaseInsensitiveFiltering: true,
            buttonWidth: '375px',
            nonSelectedText: 'Select Consumables',
            buttonClass: 'custom-multiselect-button',
             maxHeight: 250, // Set a max height for the dropdown with a scrollbar
            dropUp: false
        });
    });
</script>



{% endblock content %}