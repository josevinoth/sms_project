{% extends "asset_mgt_app/base.html" %}
{% load widget_tweaks %}
{% block content %}

<form method="POST" action="" id="needassessment_add"   >
	{% csrf_token %}
	<div class="row">
		<div class="col-2"></div>
		<div class="col-8">
			<div class="container-fluid">
				<div class="card text-white bg-info mb-3" style="max-width: 100%;">
					<div class="card-header text-center"><h3>Add/Update Need Assessment</h3></div>
					<div class="card-body bg-light" >
						<div class="row">
							<div class="col-6">
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Assessment NO.</span>
									</div>
									{% render_field form.na_assessment_num id="na_assessment_num"  readonly="True"  class="form-control" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Date</span>
									</div>
									{% render_field form.na_date id="na_date" type="Date" class="form-control" %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Customer Name</span>
									</div>
									{% render_field form.na_customer_name id="na_customer_name" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Type Of Work</span>
									</div>
									{% render_field form.na_type_of_work id="na_type_of_work" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Type Of Packing</span>
									</div>
									{% render_field form.na_type_of_pack id="na_type_of_pack" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Wood Treatment Requirement</span>
									</div>
									{% render_field form.na_wood_treatment_req  id="na_wood_treatment_req" class="form-control " %}
								</div>
							</div>
							<div class="col-6">
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Unloading</span>
									</div>
									{% render_field form.na_unloading id="na_unloading" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Wood Norms</span>
									</div>
									{% render_field form.na_wood_norms id="na_wood_norms"  class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Vehicle</span>
									</div>
									{% render_field form.na_vehicle id="na_vehicle" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Vehicle Type</span>
									</div>
									{% render_field form.na_vehicle_type id="na_vehicle_type" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Type Of Access</span>
									</div>
									{% render_field form.na_type_of_access id="na_type_of_access" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Consumables</span>
									</div>
									{% render_field form.na_consumables id="na_consumables" class="form-control " %}
								</div>
								<div class="input-group input-group-sm mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">Status</span>
									</div>
									{% render_field form.na_status id="na_status" class="form-control " %}
								</div>

								{% render_field form.na_updated_by id="na_updated_by" hidden="True" class="form-control " %}
							</div>
						</div>
						<div class="container-fluid row">
							<!--    <div class="col-md-1">-->
							<!--        <a href="{% url 'home_page' %}" class="btn btn-primary btn-block btn-lg">-->
							<!--            <i class="fas fa-arrow-left"></i> Back-->
							<!--        </a>-->
							<!--    </div>-->
							<div class="col-md-2">
								<a id="comments_add_btn" href="{% url 'comments_insert' %}" class="btn btn-success btn-block btn-lg disable_a_href">
									<i class="fas fa-plus"></i> Comments
								</a>
							</div>
						</div>
						<hr>
						<div class="container-fluid">
							<table  id="comments_list" class="table table-striped table-bordered">
								<thead class="thead-dark">
								<tr>
									<th>Created On</th>
									<th>Reference</th>
									<th>Comments</th>
									<th>Updated On</th>
									<th>Updated By</th>
									<th>Edit</th>
									<th>Delete</th>
								</thead>
								<tbody>
								{% for commentsinfo in comments_list %}
								<tr>
									<td> {{commentsinfo.comments_created_at}}</td>
									<td> {{commentsinfo.comments_ref}}</td>
									<td> {{commentsinfo.comments_remarks}}</td>
									<td> {{commentsinfo.comments_updated_at}}</td>
									<td> {{commentsinfo.comments_updated_by}}</td>
									<td>
										<a href="{% url 'comments_update' commentsinfo.id %}" class="btn btn-primary">
											<i class="far fa-edit"></i>
										</a>
									</td>
									<td>
										<form action="{% url 'comments_delete' commentsinfo.id %}" method="post" onclick="return confirm('Are you sure?');">
											{% csrf_token %}
											<button type="submit" class="btn btn-danger">
												<i class="fas fa-trash-alt"></i>
											</button>
										</form>
									</td>
								</tr>
								{% endfor %}
								</tbody>
							</table>
						</div>
						<div class="row">
							<div class="col-1"></div>
							<div class="col-10">
								<div class="message text-center">
									{% for message in messages %}
									<a {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</a>
									{% endfor %}
								</div>
							</div>
							<div class="col-1"></div>
						</div>
						<br>
						<button type="submit" class="btn btn-success "><i class="fas fa-check"></i> Submit</button>
						<a href="{% url 'needassessment_list' %}" class="btn btn-danger float-right">
							<i class="fas fa-times"></i> Cancel
						</a>
					</div>
				</div>
			</div>
		</div>
		<div class="col-2"></div>
	</div>
</form>
<div class="container-fluid row">
	<div class="col-md-1">
		<a href="{% url 'na_dimension_insert' %}" id = "add_dim_btn" class="btn btn-success btn-block btn-lg disable_a_href">
			<i class="fas fa-plus"></i> Insert
		</a>
	</div>
</div>
<hr>
<div class="container-fluid">
	<table  id="na_dimension_list" class="table table-striped table-bordered">
		<thead class="thead-dark">
		<tr>
			<th>Created On</th>
			<th>Assessment Number</th>
			<th>Requirement Type</th>
			<th>UOM</th>
			<th>Length</th>
			<th>Width</th>
			<th>Height</th>
			<th>Quantity</th>
			<th>Updated On</th>
			<th>Updated By</th>
			<th>Edit</th>
			<th>Delete</th>
		</thead>
		<tbody>
		{% for na_dimensioninfo in na_dimension_list %}
		<tr>
			<td> {{na_dimensioninfo.nad_created_at}}</td>
			<td> {{na_dimensioninfo.nad_assess_num}}</td>
			<td> {{na_dimensioninfo.nad_type_of_req}}</td>
			<td> {{na_dimensioninfo.nad_uom}}</td>
			<td> {{na_dimensioninfo.nad_length}}</td>
			<td> {{na_dimensioninfo.nad_width}}</td>
			<td> {{na_dimensioninfo.nad_height}}</td>
			<td> {{na_dimensioninfo.nad_quantity}}</td>
			<td> {{na_dimensioninfo.nad_updated_at}}</td>
			<td> {{na_dimensioninfo.nad_updated_by}}</td>
			<td>
				<a class="btn btn-primary" href="{% url 'na_dimension_update' na_dimensioninfo.id %}" class="btn btn-primary">
					<i class="far fa-edit"></i>
				</a>
			</td>
			<td>
				<form action="{% url 'na_dimension_delete' na_dimensioninfo.id %}" method="post" onclick="return confirm('Are you sure?');">
					{% csrf_token %}
					<button type="submit" id='submit' class="btn btn-danger">
						<i class="fas fa-trash-alt"></i>
					</button>
				</form>
			</td>
		</tr>
		{% endfor %}
		</tbody>
	</table>
</div>

<script>
    $(document).ready(function() {
    document.getElementById("na_updated_by").value ='{{user_id}}';
    $('#na_dimension_list').DataTable({
        dom: 'lBfrtip',
        buttons: [
            'copy', 'csv', 'excel','print'
        ]
    });
    var assessment_num = document.getElementById("na_assessment_num").value
    if (assessment_num =="")
	{
		$('#add_dim_btn').addClass('disable_a_href');
		$('#comments_add_btn').addClass('disable_a_href');
	}
	else
	{
		$('#add_dim_btn').removeClass('disable_a_href');
		$('#comments_add_btn').removeClass('disable_a_href');
	}
} );
</script>

<script>
$(document).ready(function() {
	console.log("JavaScript code is running!"); // Check if JavaScript is executing
	var user_role='{{role}}'
	var status=document.getElementById("na_status").value
	if (status==5)
	{
		if (user_role=="User")
		{
			alert('Since Status is Completed,you have read-only access. To edit, please contact Administrator')
			// Disable all form input fields
			$('#needassessment_add :input').prop('disabled', true);

			// Hide the submit button
			$('#add_dim_btn').addClass('disable_a_href');
			$('#submit').addClass('disable_a_href');
			$('#na_dimension_list').addClass('disable_a_href');;
		}
	}
});
</script>
<script>
    $(document).ready(function() {
    $('#comments_list').DataTable();
} );
</script>
{% endblock content %}